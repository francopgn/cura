<!DOCTYPE html> 
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <title>Ley C.U.R.A. | Diseñando el futuro de la Salud Pública Argentina</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@600&family=Vazirmatn:wght@400;700&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            cura: {
              primary: '#004E85',      
              primaryDark: '#00345C',  
              card: '#065D9B',         
              accent: '#00C2FF',       
              accentLight: '#59D2FF'   
            }
          },
          fontFamily: { sans: ['Inter', 'sans-serif'] }
        }
      }
    }
  </script>

  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

<style>
  /* --- ESTILOS DE LA WEB --- */
  .perspective-container { perspective: 1500px; }
  .card-container { position: relative; width: 100%; max-width: 450px; aspect-ratio: 1.58 / 1; margin: 0 auto; z-index: 20; }
  .card-inner { position: relative; width: 100%; height: 100%; transition: transform 0.8s; transform-style: preserve-3d; cursor: pointer; }
  .card-inner.is-flipped { transform: rotateY(180deg); }
  .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 18px; overflow: hidden; box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
  .card-bg-img { position: absolute; width: 100%; height: 100%; object-fit: cover; }
  .card-back { transform: rotateY(180deg); }
  @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
  .animate-float { animation: float 6s ease-in-out infinite; }

  /* --- ESTILOS PARA EL CHAT (BLUR Y BLOQUEO) --- */
  .main-content-blur {
    filter: blur(8px);
    pointer-events: none;
    transition: filter 0.3s ease;
  }

  /* Aseguramos que la burbuja y ventana del chat NUNCA se desenfoquen */
  .coze-web-chat-window-container, 
  .coze-web-chat-window-pc,
  #coze-web-chat-dot {
    filter: none !important;
    z-index: 999999 !important;
    pointer-events: auto !important;
  }
</style>
</head>

<body class="font-sans bg-cura-primary text-white overflow-x-hidden">

<div id="root-layout">
  <header class="sticky top-0 z-30 bg-cura-primaryDark border-b border-cura-accent/40 shadow-sm">
    <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-2">
        <img src="/logo.png" alt="Logo" class="h-16 w-auto" />
        <div class="leading-tight">
          <p class="text-[11px] uppercase tracking-[0.25em] text-cura-accentLight">LEY NACIONAL</p>
          <p class="text-sm font-bold">Transformación Digital Sanitaria Argentina</p>
        </div>
      </div>
    </div>
  </header>

  <main id="inicio" class="max-w-5xl mx-auto px-4 pt-10 pb-16 space-y-16">
    <section class="grid md:grid-cols-2 gap-10 items-center">
      <div data-aos="fade-right">
        <h1 class="text-3xl md:text-4xl font-extrabold mb-4">Diseñando el futuro de la Salud Pública Argentina</h1>
        <button id="btn-sumate" class="px-8 py-2.5 rounded-full bg-white text-cura-primary font-bold">QUIERO SUMARME</button>
      </div>
      <div class="card-container animate-float" data-aos="zoom-in">
        <div id="credencial-giratoria" class="card-inner">
          <div class="card-face card-front"><img src="credencial-frente-base.png" class="card-bg-img"></div>
          <div class="card-face card-back"><img src="credencial-dorso-base.png" class="card-bg-img"></div>
        </div>
      </div>
    </section>
  </main>
</div>

<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script src="https://unpkg.com/lenis@1.1.13/dist/lenis.min.js"></script> 
<script src="https://sf-cdn.coze.com/obj/unpkg-va/flow-platform/chat-app-sdk/1.2.0-beta.10/libs/oversea/index.js"></script>

<script>
// 1. Inicializar Lenis de forma GLOBAL
window.lenis = new Lenis({
  duration: 1.2,
  smoothWheel: true
});

function raf(time) {
  window.lenis.raf(time);
  requestAnimationFrame(raf);
}
requestAnimationFrame(raf);

// 2. Inicializar AOS
AOS.init({ duration: 800, once: true });

// 3. Inicializar Coze y Lógica de Interfaz
window.onload = function () {
  const layout = document.getElementById('root-layout');



  const cozeClient = new CozeWebSDK.WebChatClient({
    config: {
      type: 'bot',
      bot_id: '7596429833782214709',
      isIframe: false,
    },
    auth: {
      type: "token",
      token: "",
      onRefreshToken: async () => {
        const res = await fetch("/api/coze-token");
        const data = await res.json();
        return data.token;
      }
    },
    userInfo: { id: 'user_' + Date.now(), nickname: 'Ciudadano' },
    ui: {
      base: { layout: 'pc', lang: 'es', zIndex: 999999 },
      asstBtn: { isNeed: true },
      footer: { isShow: false },
      chatBot: { title: 'Asistente Ley C.U.R.A.', width: 390 }
    }
  });

  // --- LÓGICA DE BLUR Y BLOQUEO DE SCROLL ---
  const handleChatVisibility = () => {
    // Buscamos la ventana de chat de Coze
    const chatWin = document.querySelector('.coze-web-chat-window-pc');
    const isHidden = !chatWin || chatWin.classList.contains('coze-web-chat-window-hidden');

    if (chatWin && !isHidden) {
      // ABIERTO
      if (window.lenis) window.lenis.stop();
      layout.classList.add('main-content-blur');
      chatWin.setAttribute('data-lenis-prevent', 'true');
    } else {
      // CERRADO
      if (window.lenis) window.lenis.start();
      layout.classList.remove('main-content-blur');
    }
  };

  // Observador para cambios en el chat
  const observer = new MutationObserver(handleChatVisibility);
  observer.observe(document.body, { childList: true, subtree: true, attributes: true });

  // Refuerzo con click
  document.addEventListener('click', () => setTimeout(handleChatVisibility, 150));
  
  // Giro de credencial
  const card = document.getElementById('credencial-giratoria');
  if(card) card.onclick = () => card.classList.toggle('is-flipped');
};
</script>
</body>
</html>
