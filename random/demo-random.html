<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
    <title>Sistema C.U.R.A. | Nivel 2 (Urgencias)</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        medical: {
                            primary: '#004E85',
                            primaryDark: '#00345C',
                            blueMain: '#1f6fe5',
                            blueSoft: '#e3f0ff',
                            textDark: '#0d2b52',
                            textGray: '#64748b',
                            accent: '#00C2FF'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body { -webkit-font-smoothing: antialiased; background-color: #f0f4f8; }
        .cura-card { background: #ffffff; border-radius: 28px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); border: 1px solid #e5e7eb; }
    </style>
</head>

<body class="min-h-screen flex flex-col pt-24 font-sans">

<header class="fixed top-0 left-0 w-full bg-medical-primaryDark text-white shadow-lg z-50">
    <div class="max-w-xl mx-auto px-4 py-3 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <img src="/logo_cura.png" class="h-10 w-auto">
            <div class="leading-tight">
                <h1 class="text-[10px] font-extrabold uppercase tracking-widest text-medical-accent">C.U.R.A.</h1>
                <p class="text-[9px] opacity-80 font-bold uppercase">Nivel 2 (Urgencias)</p>
            </div>
        </div>
        <div class="text-right leading-tight">
            <span id="random-medico" class="text-[10px] font-bold opacity-90 uppercase"></span>
        </div>
    </div>
</header>

<main class="w-full max-w-lg mx-auto px-5 py-6 space-y-5">

    <div class="pb-2">
        <button onclick="window.location.reload()" class="w-full bg-white text-medical-primary hover:bg-gray-100 px-4 py-3 rounded-2xl flex items-center justify-center gap-3 shadow-sm border border-gray-200 active:scale-95 transition-all">
            <i class="ph-bold ph-arrows-clockwise text-lg"></i>
            <span class="text-xs font-bold uppercase tracking-wide">Actualizar Caso Clínico</span>
        </button>
    </div>

    <div class="text-center pb-2">
        <p id="hora-acceso" class="text-[11px] font-bold text-medical-textGray uppercase tracking-tighter leading-tight"></p>
    </div>

    <section class="cura-card p-6 relative overflow-hidden">
        <div class="absolute left-0 top-0 bottom-0 w-1.5 bg-medical-primary"></div>
        <div class="flex items-center gap-5">
            <div class="relative flex-shrink-0">
                <div class="w-20 h-20 rounded-full bg-gray-100 border-4 border-medical-light overflow-hidden shadow-sm">
                    <img id="foto-paciente" src="" class="w-full h-full object-cover">
                </div>
                <div id="tipo-sangre" class="absolute -bottom-1 -right-1 flex items-center justify-center w-9 h-9 rounded-full bg-medical-blueMain text-white text-[11px] font-black border-2 border-white shadow-md">--</div>
            </div>
            <div class="flex-grow">
                <h2 id="nombre-completo" class="text-xl font-extrabold text-medical-textDark leading-none mb-2 uppercase tracking-tight"></h2>
                <div class="space-y-1">
                    <p class="text-xs font-bold text-medical-textGray uppercase">D.N.I.: <span id="dni" class="text-medical-textDark"></span></p>
                    <p class="text-xs font-bold text-medical-textGray uppercase">Nac: <span id="fecha-nac" class="text-medical-textDark"></span> (<span id="edad" class="text-medical-textDark"></span> años)</p>
                </div>
            </div>
        </div>
        <div class="mt-6 pt-5 border-t border-gray-100">
            <button class="w-full bg-gradient-to-r from-medical-blueMain to-medical-primary text-white font-bold py-4 px-6 rounded-2xl flex items-center justify-center gap-3 shadow-lg active:scale-95 transition-all uppercase text-xs">
                <i class="ph-fill ph-phone-outgoing text-xl"></i>
                Llamar Contacto de Emergencia
            </button>
        </div>
    </section>

    <section class="bg-yellow-50 border-2 border-yellow-100 rounded-[28px] p-6 shadow-sm">
        <div class="flex items-center gap-3 mb-3">
            <div class="w-8 h-8 bg-yellow-600 text-white rounded-full flex items-center justify-center"><i class="ph-fill ph-warning text-lg"></i></div>
            <h3 class="text-yellow-800 font-black text-xs uppercase tracking-widest">Advertencias Críticas</h3>
        </div>
        <ul id="lista-advertencias" class="text-xs text-yellow-900 space-y-2 font-bold leading-relaxed"></ul>
    </section>

    <section class="space-y-3">
        <h3 class="text-[11px] font-black text-medical-textGray uppercase tracking-widest px-2">Condiciones Relevantes</h3>
        <div id="lista-condiciones" class="grid grid-cols-1 gap-3"></div>
    </section>

    <section class="space-y-3">
        <h3 class="text-[11px] font-black text-medical-textGray uppercase tracking-widest px-2">Implantes y Dispositivos</h3>
        <div id="lista-implantes" class="space-y-3"></div>
    </section>

    <section class="space-y-3">
        <h3 class="text-[11px] font-black text-medical-textGray uppercase tracking-widest px-2">Medicación Actual</h3>
        <div class="cura-card overflow-hidden">
            <ul id="lista-medicacion" class="divide-y divide-gray-100"></ul>
        </div>
    </section>

</main>

<footer class="mt-auto bg-white border-t border-gray-100 py-10 px-6 opacity-60">
    <div class="flex flex-col items-center gap-3 text-center">
        <img src="https://datos.salud.gob.ar/user_images/logo_nuevo_msal_encabezado%202.jpg" class="h-8 grayscale">
        <p class="text-[10px] font-black text-medical-textGray uppercase tracking-widest">Protocolo de Privacidad Federal · 2026</p>
    </div>
</footer>

<script>
function randInt(min, max){return Math.floor(Math.random()*(max-min+1))+min;}
function choice(arr){return arr[randInt(0, arr.length-1)];}
function fechaRandom(){
    const y = randInt(1945, 2010);
    const m = randInt(1,12);
    const d = randInt(1, [4,6,9,11].includes(m)?30:(m===2?28:31));
    return {d,m,y};
}
function formatear(d,m,y){return d.toString().padStart(2,'0')+'/'+m.toString().padStart(2,'0')+'/'+y;}
function edad(d,m,y){
    const n=new Date(y,m-1,d),h=new Date();let e=h.getFullYear()-n.getFullYear();
    if(h.getMonth()<n.getMonth()||(h.getMonth()===n.getMonth()&&h.getDate()<n.getDate()))e--;
    return e;
}

const nombresM=['Franco','Juan','Lucas','Santiago','Matías','Agustín','Iván','Tomás','Bruno','Ezequiel'];
const nombresF=['Sofía','Camila','Valentina','Julieta','Martina','Ana','Paula','Rocío','Florencia','Lorena'];
const apellidos=['Gómez','Rodríguez','Paganini','Fernández','López','Sánchez','Romero','Martínez','García','Argüello'];
const sangres=['O+','A+','B+','AB+','O-','A-','B-','AB-'];
const medicos = ["Dr. Fabián Alonso","Dra. Julieta Ruiz","Dr. Mauro Etcheverry","Dra. Florencia Rivas","Dr. Sebastián López","Dra. Ana Beltrán"];

const condicionesCatalogo = [
    {titulo:'Diabetes Tipo 2', subt:'Control metabólico', adv:['Riesgo de hipoglucemia'], meds:[['Metformina 850 mg','Hipoglucemiante']]},
    {titulo:'Hipertensión Arterial', subt:'Grado II', adv:['Controlar T.A. al ingreso'], meds:[['Enalapril 10 mg','IECA']]},
    {titulo:'Asma Bronquial', subt:'Moderada', adv:['Riesgo de broncoespasmo'], meds:[['Salbutamol','Broncodilatador']]},
    {titulo:'Fibrilación Auricular', subt:'Arritmia crónica', adv:['RIESGO HEMORRÁGICO ALTO'], meds:[['Apixabán 5 mg','Anticoagulante']]},
    {titulo:'EPOC', subt:'Enfermedad Pulmonar', adv:['Meta Saturación: 88-92%'], meds:[['Tiotropio','Broncodilatador']]},
    {titulo:'Epilepsia', subt:'Neurológica clínica', adv:['Proteger vía aérea en crisis'], meds:[['Levetiracetam 500 mg','Anticonvulsivo']]},
    {titulo:'Insuficiencia Cardíaca', subt:'Congestiva', adv:['Control de balance hídrico'], meds:[['Furosemida 40 mg','Diurético']]},
    {titulo:'Hipotiroidismo', subt:'Sustitución hormonal', adv:['Administrar en ayunas'], meds:[['Levotiroxina 100 mcg','Hormona']]},
    {titulo:'Enfermedad de Parkinson', subt:'Postural', adv:['Riesgo de caídas alto'], meds:[['Levodopa/Carbidopa','Dopaminérgico']]},
    {titulo:'Gastritis Erosiva', subt:'Reflujo severo', adv:['Evitar AINES (Ibuprofeno)'], meds:[['Pantoprazol 40 mg','Protector']]},
    {titulo:'Artritis Reumatoidea', subt:'Autoinmune', adv:['Paciente Inmunosuprimido'], meds:[['Metotrexato','Inmunomodulador']]},
    {titulo:'Gota / Hiperuricemia', subt:'Articular', adv:['Consultar función renal'], meds:[['Alopurinol 300 mg','Uricosúrico']]},
    {titulo:'Glaucoma', subt:'Ángulo abierto', adv:['Evitar Atropina en guardia'], meds:[['Timolol 0.5%','Gotas oft.']]}
];

const implantes = [
    {t:'Bomba de Morfina', d:'Infusión intratecal', a:'Bomba programable. No suspender.', icon:'ph-fill ph-pill'},
    {t:'Válvula DVP', d:'Hidrocefalia', a:'Sensible a imanes de alta potencia.', icon:'ph-fill ph-brain'},
    {t:'Neuroestimulador', d:'Dolor neuropático', a:'Dispositivo electrónico implantado.', icon:'ph-fill ph-cpu'},
    {t:'Marcapasos Bicameral', d:'Bloqueo AV', a:'Evitar campos electromagnéticos.', icon:'ph-fill ph-heartbeat'},
    {t:'DAI (Desfibrilador)', d:'Prevención muerte súbita', a:'Peligro con bisturí eléctrico.', icon:'ph-fill ph-lightning-bold'},
    {t:'Placa de Titanio', d:'Osteosíntesis húmero', a:'Compatible con RM.', icon:'ph-fill ph-bone'},
    {t:'Bomba de Insulina', d:'Infusión continua', a:'No retirar sin supervisión.', icon:'ph-fill ph-drop'}
];

document.addEventListener("DOMContentLoaded",()=>{
    const ahora = new Date();
    const opciones = { weekday: 'short', day: '2-digit', month: 'short', hour: '2-digit', minute: '2-digit' };
    document.getElementById("hora-acceso").innerText = "ACCESO REGISTRADO: " + ahora.toLocaleDateString('es-AR', opciones).toUpperCase();
    document.getElementById("random-medico").innerHTML = `${choice(medicos)}<br>M.P.: ${randInt(10000, 99999)}<br>M.N.: ${randInt(100000, 999999)}`;

    const sexo = Math.random() < 0.5 ? 'M' : 'F';
    document.getElementById("nombre-completo").textContent = choice(sexo==='M'?nombresM:nombresF) + " " + choice(apellidos);
    document.getElementById("foto-paciente").src = `https://randomuser.me/api/portraits/${sexo==='M'?'men/':'women/'}${randInt(1,99)}.jpg`;
    document.getElementById("dni").textContent = randInt(15000000,50000000).toLocaleString('es-AR');
    const fn = fechaRandom();
    document.getElementById("fecha-nac").textContent = formatear(fn.d, fn.m, fn.y);
    document.getElementById("edad").textContent = edad(fn.d, fn.m, fn.y);
    document.getElementById("tipo-sangre").textContent = choice(sangres);

    /* LÓGICA DE EQUILIBRIO (demo-random 7) */
    const prob = Math.random();
    let numCond = prob < 0.1 ? 0 : (prob < 0.8 ? 1 : 2); 
    const usadas = [];
    const advArr = [];
    const contCond = document.getElementById("lista-condiciones");
    const meds = document.getElementById("lista-medicacion");

    if (numCond === 0) {
        contCond.innerHTML = `<p class="text-xs text-medical-textGray italic px-2">Sin condiciones reportadas.</p>`;
        meds.innerHTML = `<li class="p-4 text-xs text-medical-textGray italic">Sin medicación en curso.</li>`;
    } else {
        while(usadas.length < numCond){
            const c = choice(condicionesCatalogo);
            if(!usadas.includes(c)){
                usadas.push(c);
                advArr.push(...c.adv);
                contCond.innerHTML += `<div class="cura-card p-4 flex gap-4"><div class="w-10 h-10 rounded-xl bg-blue-50 text-blue-600 flex items-center justify-center flex-shrink-0"><i class="ph-fill ph-activity text-xl"></i></div><div><p class="text-sm font-bold text-medical-textDark">${c.titulo}</p><p class="text-[11px] font-medium text-medical-textGray">${c.subt}</p></div></div>`;
                c.meds.forEach(m => {
                    meds.innerHTML += `<li class="p-4 flex justify-between items-center"><span class="text-sm font-bold text-medical-primary">${m[0]}</span><span class="text-[10px] font-black bg-gray-100 px-2 py-1 rounded-lg uppercase text-medical-textGray">${m[1]}</span></li>`;
                });
            }
        }
    }

    const contImpl = document.getElementById("lista-implantes");
    if(Math.random() < 0.45){
        const im = choice(implantes);
        advArr.push(im.a);
        contImpl.innerHTML = `<div class="cura-card p-4 flex gap-4"><div class="w-10 h-10 rounded-xl bg-indigo-50 text-indigo-600 flex items-center justify-center flex-shrink-0"><i class="${im.icon} text-xl"></i></div><div><p class="text-sm font-bold text-medical-textDark">${im.t}</p><p class="text-[11px] font-medium text-medical-textGray">${im.d}</p></div></div>`;
    } else {
        contImpl.innerHTML = `<p class="text-xs text-medical-textGray italic px-2">No se detectan implantes.</p>`;
    }

    const advC = document.getElementById("lista-advertencias");
    const unicas = [...new Set(advArr)];
    if (unicas.length === 0) { advC.innerHTML = `<li>• Sin advertencias reportadas.</li>`; } 
    else { unicas.forEach(a => { advC.innerHTML += `<li>• ${a}</li>`; }); }
});
</script>
</body>
</html>
